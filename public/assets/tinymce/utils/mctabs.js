/**
 * mctabs.js
 *
 * Copyright 2009, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://tinymce.moxiecode.com/license
 * Contributing: http://tinymce.moxiecode.com/contributing
 */
function MCTabs(){this.settings=[],this.onChange=tinyMCEPopup.editor.windowManager.createInstance("tinymce.util.Dispatcher")}MCTabs.prototype.init=function(e){this.settings=e},MCTabs.prototype.getParam=function(e,t){var n=null;return n=typeof this.settings[e]=="undefined"?t:this.settings[e],n=="true"||n=="false"?n=="true":n},MCTabs.prototype.showTab=function(e){e.className="current",e.setAttribute("aria-selected",!0),e.setAttribute("aria-expanded",!0),e.tabIndex=0},MCTabs.prototype.hideTab=function(e){var t=this;e.className="",e.setAttribute("aria-selected",!1),e.setAttribute("aria-expanded",!1),e.tabIndex=-1},MCTabs.prototype.showPanel=function(e){e.className="current",e.setAttribute("aria-hidden",!1)},MCTabs.prototype.hidePanel=function(e){e.className="panel",e.setAttribute("aria-hidden",!0)},MCTabs.prototype.getPanelForTab=function(e){return tinyMCEPopup.dom.getAttrib(e,"aria-controls")},MCTabs.prototype.displayTab=function(e,t,n){var r,i,s,o,u,a,f,l=this;s=document.getElementById(e),t===undefined&&(t=l.getPanelForTab(s)),r=document.getElementById(t),i=r?r.parentNode:null,o=s?s.parentNode:null,u=l.getParam("selection_class","current");if(s&&o){a=o.childNodes;for(f=0;f<a.length;f++)a[f].nodeName=="LI"&&l.hideTab(a[f]);l.showTab(s)}if(r&&i){a=i.childNodes;for(f=0;f<a.length;f++)a[f].nodeName=="DIV"&&l.hidePanel(a[f]);n||s.focus(),l.showPanel(r)}},MCTabs.prototype.getAnchor=function(){var e,t=document.location.href;return(e=t.lastIndexOf("#"))!=-1?t.substring(e+1):""};var mcTabs=new MCTabs;tinyMCEPopup.onInit.add(function(){var e=tinyMCEPopup.getWin().tinymce,t=tinyMCEPopup.dom,n=e.each;n(t.select("div.tabs"),function(r){var i;t.setAttrib(r,"role","tablist");var s=tinyMCEPopup.dom.select("li",r),o=function(e){mcTabs.displayTab(e,mcTabs.getPanelForTab(e)),mcTabs.onChange.dispatch(e)};n(s,function(e){t.setAttrib(e,"role","tab"),t.bind(e,"click",function(t){o(e.id)})}),t.bind(t.getRoot(),"keydown",function(t){t.keyCode===9&&t.ctrlKey&&!t.altKey&&(i.moveFocus(t.shiftKey?-1:1),e.dom.Event.cancel(t))}),n(t.select("a",r),function(e){t.setAttrib(e,"tabindex","-1")}),i=tinyMCEPopup.editor.windowManager.createInstance("tinymce.ui.KeyboardNavigation",{root:r,items:s,onAction:o,actOnFocus:!0,enableLeftRight:!0,enableUpDown:!0},tinyMCEPopup.dom)})});