/**
 * @filename : editor_plugin.js
 * @description : jQuery UI Inline Popups plugin to replace the default inlinepopups
 * @developer : badsyntax (Richard Willis)
 * @contact : http://badsyntax.co
 * @moreinfo : http://is.gd/j1FuI
 */
(function(){var a=tinymce.DOM,b=tinymce.dom.Event,c=tinymce.each;tinymce.create("tinymce.plugins.jQueryInlinePopups",{init:function(a,b){a.onBeforeRenderUI.add(function(){a.windowManager=new tinymce.InlineWindowManager(a)})},getInfo:function(){return{longname:"jQuery UI Inline Popups",author:"Richard Willis",authorurl:"http://badsyntax.co",infourl:"http://is.gd/j1FuI",version:"0.1b"}}}),tinymce.create("tinymce.InlineWindowManager:tinymce.WindowManager",{InlineWindowManager:function(a){this.parent(a),this.windows={}},open:function(b,c){console.log(b),b=b||{},c=c||{};if(!b.inline)return d.parent(b,c);var d=this,e=a.uniqueId(),f={title:b.title||"",width:"auto",height:"auto",modal:!0,resizable:!1,draggable:!0,dialogClass:"ui-dialog-tinymce",zIndex:3e5},g=$("<div />").attr("id","dialog-"+e).hide().appendTo("body"),h={id:e,features:b,element:g};b.type||(this.bookmark=this.editor.selection.getBookmark(1));if(b.content)b.type=="confirm"?f.buttons=[{text:"Ok",click:function(a){b.button_func(!0)}},{text:"Cancel",click:function(a){b.button_func(!1)}}]:b.type=="alert"&&(f.buttons=[{text:"Ok",click:function(a){b.button_func(!0)}}]),f.width=b.width,g.html($("<div />",{"class":"ui-dialog-tinymce-content",html:b.content}));else{console.log(b);var i=$("<iframe />",{id:e+"_ifr",frameborder:0}).css({width:b.width,height:b.height}).appendTo(g)}return c.mce_inline=!0,c.mce_window_id=e,c.mce_auto_focus=b.auto_focus,this.features=b,this.params=c,this.onOpen.dispatch(this,b,c),g.dialog(f),b.content||(i.attr("src",b.url||b.file),i.load(function(){var a=$(i).contents();buttonPane=$("<div></div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),g.after(buttonPane),buttons=$("<div></div>").addClass("button-wrapper").appendTo(buttonPane),a.find(".mceActionPanel").hide().find("input[type=button], input[type=submit]").each(function(){var a=$(this),b;a.attr("id")=="cancel"?(b=$("<a></a>").attr("href","#").attr("id","close-link").html(a.val()),buttonPane.append(b)):(b=$("<a></a>").attr("href","#").addClass("button").html(a.val()),buttons.append(b)),b.bind("click",function(b){b.stopPropagation(),b.preventDefault(),a.trigger("click")})})})),d.windows[e]=h,h},resizeBy:function(a,b,c){return},focus:function(a){return},close:function(a,b){var c=this,d,b=b||a.frameElement.id.replace(/_ifr$/,"");if(!c.windows[b]){c.parent(a);return}if(d=c.windows[b])d.element.dialog("destroy").remove(),delete c.windows[b]},setTitle:function(a,b){var c=a.frameElement.id.replace(/_ifr$/,"");$("#ui-dialog-title-dialog-"+c).html(b)},alert:function(a,b,c){this._messagePopup("alert","Alert",a,b,c)},confirm:function(a,b,c){this._messagePopup("confirm","Confirm",a,b,c)},_messagePopup:function(b,c,d,e,f){var g=this,h;h=g.open({title:c,type:b,button_func:function(a){e&&e.call(a||g,a),g.close(null,h.id)},content:a.encode(g.editor.getLang(d,d)),inline:1,width:400,height:130})}}),tinymce.PluginManager.add("jqueryinlinepopups",tinymce.plugins.jQueryInlinePopups)})();