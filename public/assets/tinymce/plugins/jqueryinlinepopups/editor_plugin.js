/**
 * @filename : editor_plugin.js
 * @description : jQuery UI Inline Popups plugin to replace the default inlinepopups
 * @developer : badsyntax (Richard Willis)
 * @contact : http://badsyntax.co
 * @moreinfo : http://is.gd/j1FuI
 */
(function(){var e=tinymce.DOM,t=tinymce.dom.Event,n=tinymce.each;tinymce.create("tinymce.plugins.jQueryInlinePopups",{init:function(e,t){e.onBeforeRenderUI.add(function(){e.windowManager=new tinymce.InlineWindowManager(e)})},getInfo:function(){return{longname:"jQuery UI Inline Popups",author:"Richard Willis",authorurl:"http://badsyntax.co",infourl:"http://is.gd/j1FuI",version:"0.1b"}}}),tinymce.create("tinymce.InlineWindowManager:tinymce.WindowManager",{InlineWindowManager:function(e){this.parent(e),this.windows={}},open:function(t,n){t=t||{},n=n||{};if(!t.inline)return r.parent(t,n);var r=this,i=e.uniqueId(),s={title:t.title||"",width:"auto",height:"auto",modal:!0,resizable:!1,draggable:!0,dialogClass:"ui-dialog-tinymce",zIndex:3e5},o=$("<div />").attr("id","dialog-"+i).hide().appendTo("body"),u={id:i,features:t,element:o};t.type||(this.bookmark=this.editor.selection.getBookmark(1));if(t.content)t.type=="confirm"?s.buttons=[{text:"Ok",click:function(e){t.button_func(!0)}},{text:"Cancel",click:function(e){t.button_func(!1)}}]:t.type=="alert"&&(s.buttons=[{text:"Ok",click:function(e){t.button_func(!0)}}]),s.width=t.width,o.html($("<div />",{"class":"ui-dialog-tinymce-content",html:t.content}));else{console.log(t);var a=$("<iframe />",{id:i+"_ifr",frameborder:0}).css({width:t.width,height:t.height}).appendTo(o)}return n.mce_inline=!0,n.mce_window_id=i,n.mce_auto_focus=t.auto_focus,this.features=t,this.params=n,this.onOpen.dispatch(this,t,n),o.dialog(s),t.content||(a.attr("src",t.url||t.file),a.load(function(){var e=$(a).contents();buttonPane=$("<div></div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),o.after(buttonPane),buttons=$("<div></div>").addClass("button-wrapper").appendTo(buttonPane),e.find(".mceActionPanel").hide().find("input[type=button], input[type=submit]").each(function(){var e=$(this),t;e.attr("id")=="cancel"?(t=$("<a></a>").attr("href","#").attr("id","close-link").html(e.val()),buttonPane.append(t)):(t=$("<a></a>").attr("href","#").addClass("button").html(e.val()),buttons.append(t)),t.bind("click",function(t){t.stopPropagation(),t.preventDefault(),e.trigger("click")})})})),r.windows[i]=u,u},resizeBy:function(e,t,n){return},focus:function(e){return},close:function(e,t){var n=this,r,t=t||e.frameElement.id.replace(/_ifr$/,"");if(!n.windows[t]){n.parent(e);return}if(r=n.windows[t])r.element.dialog("destroy").remove(),delete n.windows[t]},setTitle:function(e,t){var n=e.frameElement.id.replace(/_ifr$/,"");$("#ui-dialog-title-dialog-"+n).html(t)},alert:function(e,t,n){this._messagePopup("alert","Alert",e,t,n)},confirm:function(e,t,n){this._messagePopup("confirm","Confirm",e,t,n)},_messagePopup:function(t,n,r,i,s){var o=this,u;u=o.open({title:n,type:t,button_func:function(e){i&&i.call(e||o,e),o.close(null,u.id)},content:e.encode(o.editor.getLang(r,r)),inline:1,width:400,height:130})}}),tinymce.PluginManager.add("jqueryinlinepopups",tinymce.plugins.jQueryInlinePopups)})();