/**
 * editor_plugin_src.js
 *
 * Copyright 2009, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://tinymce.moxiecode.com/license
 * Contributing: http://tinymce.moxiecode.com/contributing
 */
(function(){var e=tinymce.dom.Event,t=tinymce.each,n=tinymce.DOM;tinymce.create("tinymce.plugins.ContextMenu",{init:function(t){function o(t,r){s=0;if(r&&r.button==2){s=r.ctrlKey;return}n._menu&&(n._menu.removeAll(),n._menu.destroy(),e.remove(t.getDoc(),"click",o))}var n=this,r,i,s;n.editor=t,i=t.settings.contextmenu_never_use_native,n.onContextMenu=new tinymce.util.Dispatcher(this),r=t.onContextMenu.add(function(t,r){if((s!==0?s:r.ctrlKey)&&!i)return;e.cancel(r),r.target.nodeName=="IMG"&&t.selection.select(r.target),n._getMenu(t).showMenu(r.clientX||r.pageX,r.clientY||r.pageY),e.add(t.getDoc(),"click",function(e){o(t,e)}),t.nodeChanged()}),t.onRemove.add(function(){n._menu&&n._menu.removeAll()}),t.onMouseDown.add(o),t.onKeyDown.add(o),t.onKeyDown.add(function(t,n){n.shiftKey&&!n.ctrlKey&&!n.altKey&&n.keyCode===121&&(e.cancel(n),r(t,n))})},getInfo:function(){return{longname:"Contextmenu",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/contextmenu",version:tinymce.majorVersion+"."+tinymce.minorVersion}},_getMenu:function(e){var t=this,r=t._menu,i=e.selection,s=i.isCollapsed(),o=i.getNode()||e.getBody(),u,a;r&&(r.removeAll(),r.destroy()),a=n.getPos(e.getContentAreaContainer()),r=e.controlManager.createDropMenu("contextmenu",{offset_x:a.x+e.getParam("contextmenu_offset_x",0),offset_y:a.y+e.getParam("contextmenu_offset_y",0),constrain:1,keyboard_focus:!0}),t._menu=r,r.add({title:"advanced.cut_desc",icon:"cut",cmd:"Cut"}).setDisabled(s),r.add({title:"advanced.copy_desc",icon:"copy",cmd:"Copy"}).setDisabled(s),r.add({title:"advanced.paste_desc",icon:"paste",cmd:"Paste"});if(o.nodeName=="A"&&!e.dom.getAttrib(o,"name")||!s)r.addSeparator(),r.add({title:"advanced.link_desc",icon:"link",cmd:e.plugins.advlink?"mceAdvLink":"mceLink",ui:!0}),r.add({title:"advanced.unlink_desc",icon:"unlink",cmd:"UnLink"});return r.addSeparator(),r.add({title:"advanced.image_desc",icon:"image",cmd:e.plugins.advimage?"mceAdvImage":"mceImage",ui:!0}),r.addSeparator(),u=r.addMenu({title:"contextmenu.align"}),u.add({title:"contextmenu.left",icon:"justifyleft",cmd:"JustifyLeft"}),u.add({title:"contextmenu.center",icon:"justifycenter",cmd:"JustifyCenter"}),u.add({title:"contextmenu.right",icon:"justifyright",cmd:"JustifyRight"}),u.add({title:"contextmenu.full",icon:"justifyfull",cmd:"JustifyFull"}),t.onContextMenu.dispatch(t,r,o,s),r}}),tinymce.PluginManager.add("contextmenu",tinymce.plugins.ContextMenu)})();