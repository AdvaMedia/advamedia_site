/*!
* Aloha Editor
* Author & Copyright (c) 2010 Gentics Software GmbH
* aloha-sales@gentics.com
* Licensed unter the terms of http://www.aloha-editor.com/license.html
*/
define(["aloha/jquery","aloha/plugin","aloha/floatingmenu","i18n!headerids/nls/i18n","i18n!aloha/nls/i18n","css!headerids/css/headerids.css"],function(a,b,c,d,e){function j(){var a=[],b=i;return f.each(arguments,function(){a.push("."+(this==""?b:b+"-"+this))}),a.join(" ").trim()}function k(){var a=[],b=i;return f.each(arguments,function(){a.push(this==""?b:b+"-"+this)}),a.join(" ").trim()}var f=a,g=window.GENTICS,h=window.Aloha,i="aloha-headerids";return b.create("headerids",{_constructor:function(){this._super("headerids")},config:["true"],init:function(){var a=this;h.bind("aloha-editable-activated",function(b,c){a.check(c.editable.obj)}),h.bind("aloha-editable-deactivated",function(b,c){a.check(c.editable.obj)}),h.bind("aloha-ready",function(b){a.initSidebar(h.Sidebar.right)})},check:function(b){var c=this,d=c.getEditableConfig(b);if(a.inArray("true",d)==-1)return;a(b).find("h1, h2, h3, h4, h5, h6").not(".aloha-customized").each(function(){c.processH(this)})},processH:function(b){var c=this;a(b).attr("id",c.sanitize(a(b).text()))},sanitize:function(a){return a.replace(/[^a-z0-9]+/gi,"_")},initSidebar:function(b){var c=this;c.sidebar=b,b.addPanel({id:k("sidebar-panel"),title:"Sprungmarken",content:"",expanded:!0,activeOn:"h1, h2, h3, h4, h5, h6",onInit:function(){var b=this,e=this.setContent('<label class="'+k("label")+'" for="'+k("input")+'">'+d.t("headerids.label.target")+'</label><input id="'+k("input")+'" class="'+k("input")+'" type="text" name="value"/> <button class="'+k("reset-button")+'">'+d.t("headerids.button.reset")+'</button><button class="'+k("set-button")+'">'+d.t("headerids.button.set")+"</button>").content;e.find(j("set-button")).click(function(){var c=b.content;a(b.effective).attr("id",a(j("input")).val()),a(b.effective).addClass("aloha-customized")}),e.find(j("reset-button")).click(function(){var d=b.content;c.processH(b.effective),a(b.effective).removeClass("aloha-customized"),b.content.find(j("input")).val(b.effective.attr("id"))})},onActivate:function(a){var b=this;b.effective=a,b.content.find(j("input")).val(a.attr("id"))}}),b.show()}})});