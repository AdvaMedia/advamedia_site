/*!
* Aloha Editor
* Author & Copyright (c) 2010 Gentics Software GmbH
* aloha-sales@gentics.com
* Licensed unter the terms of http://www.aloha-editor.com/license.html
*/
define(["aloha/jquery","aloha/plugin","aloha/floatingmenu","i18n!headerids/nls/i18n","i18n!aloha/nls/i18n","css!headerids/css/headerids.css"],function(e,t,n,r,i){function f(){var e=[],t=a;return s.each(arguments,function(){e.push("."+(this==""?t:t+"-"+this))}),e.join(" ").trim()}function l(){var e=[],t=a;return s.each(arguments,function(){e.push(this==""?t:t+"-"+this)}),e.join(" ").trim()}var s=e,o=window.GENTICS,u=window.Aloha,a="aloha-headerids";return t.create("headerids",{_constructor:function(){this._super("headerids")},config:["true"],init:function(){var e=this;u.bind("aloha-editable-activated",function(t,n){e.check(n.editable.obj)}),u.bind("aloha-editable-deactivated",function(t,n){e.check(n.editable.obj)}),u.bind("aloha-ready",function(t){e.initSidebar(u.Sidebar.right)})},check:function(t){var n=this,r=n.getEditableConfig(t);if(e.inArray("true",r)==-1)return;e(t).find("h1, h2, h3, h4, h5, h6").not(".aloha-customized").each(function(){n.processH(this)})},processH:function(t){var n=this;e(t).attr("id",n.sanitize(e(t).text()))},sanitize:function(e){return e.replace(/[^a-z0-9]+/gi,"_")},initSidebar:function(t){var n=this;n.sidebar=t,t.addPanel({id:l("sidebar-panel"),title:"Sprungmarken",content:"",expanded:!0,activeOn:"h1, h2, h3, h4, h5, h6",onInit:function(){var t=this,i=this.setContent('<label class="'+l("label")+'" for="'+l("input")+'">'+r.t("headerids.label.target")+'</label><input id="'+l("input")+'" class="'+l("input")+'" type="text" name="value"/> <button class="'+l("reset-button")+'">'+r.t("headerids.button.reset")+'</button><button class="'+l("set-button")+'">'+r.t("headerids.button.set")+"</button>").content;i.find(f("set-button")).click(function(){var n=t.content;e(t.effective).attr("id",e(f("input")).val()),e(t.effective).addClass("aloha-customized")}),i.find(f("reset-button")).click(function(){var r=t.content;n.processH(t.effective),e(t.effective).removeClass("aloha-customized"),t.content.find(f("input")).val(t.effective.attr("id"))})},onActivate:function(e){var t=this;t.effective=e,t.content.find(f("input")).val(e.attr("id"))}}),t.show()}})});